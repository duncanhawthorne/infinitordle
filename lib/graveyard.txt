Widget streamBuilderWrapperOnCollection() {
  return StreamBuilder<QuerySnapshot>(
    stream: usersStream,
    builder: (BuildContext context, AsyncSnapshot<QuerySnapshot> snapshot) {
      if (snapshot.hasError) {
      } else if (snapshot.connectionState == ConnectionState.waiting) {
      } else {
        String snapshotCurrent = getDataFromSnapshot(snapshot);
        if (snapshotCurrent != snapshotLast && gUser != gUserDefault) {
          loadKeysReal(snapshotCurrent);
          snapshotLast = snapshotCurrent;
        }
      }
      return _wrapStructure();
    },
  );
}

Widget keyboardWidget(onKeyboardTapped) {
  return Container(
    constraints: BoxConstraints(
        maxWidth:
        keyboardSingleKeyEffectiveMaxPixelHeight * 10 / keyAspectRatioLive,
        maxHeight: keyboardSingleKeyEffectiveMaxPixelHeight * 3),
    child: GridView.builder(
        physics: const NeverScrollableScrollPhysics(), //ios fix
        itemCount: 30,
        gridDelegate: SliverGridDelegateWithFixedCrossAxisCount(
          crossAxisCount: 10,
          childAspectRatio: 1 / keyAspectRatioLive,
        ),
        itemBuilder: (BuildContext context, int index) {
          return _kbStackWithMiniGrid(index, 10, onKeyboardTapped);
        }),
  );
}

// ignore: unused_element
Widget _aspectRatioStructure() {
  //bool tall = MediaQuery.of(context).size.width <
  //    2 * 0.75 * (MediaQuery.of(context).size.height - 56);
  return Center(
    child: Container(
      color: bg,
      child: Column(
        crossAxisAlignment: CrossAxisAlignment.center,
        //mainAxisAlignment: MainAxisAlignment.center,
        children: [
          Expanded(
              flex: 75,
              child: Flex(
                  direction: numPresentationBigRowsOfBoards == 2
                      ? Axis.vertical
                      : Axis.horizontal,
                  mainAxisAlignment: MainAxisAlignment.spaceBetween,
                  children: [
                    Expanded(
                        flex: 50,
                        child: Row(
                            mainAxisAlignment: MainAxisAlignment.spaceBetween,
                            //crossAxisAlignment: CrossAxisAlignment.stretch,
                            children: [
                              Expanded(
                                  flex: 50,
                                  child: Column(
                                    children: [
                                      Expanded(
                                          flex: 50,
                                          child: AspectRatio(
                                              aspectRatio:
                                              5 / numRowsPerBoard,
                                              child: gameboardWidget(0))),
                                    ],
                                  )),
                              Expanded(
                                  flex: 50,
                                  child: Column(
                                    children: [
                                      Expanded(
                                          flex: 50,
                                          child: AspectRatio(
                                              aspectRatio:
                                              5 / numRowsPerBoard,
                                              child: gameboardWidget(0))),
                                    ],
                                  ))
                            ])),
                    Expanded(
                        flex: 50,
                        child: Row(
                          //crossAxisAlignment: CrossAxisAlignment.stretch,
                            children: [
                              Expanded(
                                  flex: 50,
                                  child: Column(
                                    children: [
                                      Expanded(
                                          flex: 50,
                                          child: AspectRatio(
                                              aspectRatio:
                                              5 / numRowsPerBoard,
                                              child: gameboardWidget(0))),
                                    ],
                                  )),
                              Expanded(
                                  flex: 50,
                                  child: Column(
                                    children: [
                                      Expanded(
                                          flex: 50,
                                          child: AspectRatio(
                                              aspectRatio:
                                              5 / numRowsPerBoard,
                                              child: gameboardWidget(0))),
                                    ],
                                  ))
                            ])),
                  ])),
          Expanded(
              flex: 25,
              child: AspectRatio(
                  aspectRatio: 10 / (3 * keyAspectRatioDefault),
                  child: keyboardWidget(onKeyboardTapped))
            /*
              Flex(
                  direction: tall ? Axis.vertical : Axis.horizontal,
                  children: [
                    Expanded(
                        flex: 100,
                        child: Row(
                          //crossAxisAlignment: CrossAxisAlignment.stretch,
                            children: [
                              Expanded(
                                  flex: 100,
                                  child: Column(
                                    children: [
                                      Expanded(
                                          flex: 100,
                                          child: AspectRatio(
                                              aspectRatio: 10 / (3 * keyAspectRatio),
                                              child: _keyboardWidget())),
                                    ],
                                  )),

                            ])),
                  ]),
        */
          ),
        ],
      ),
    ),
  );
}